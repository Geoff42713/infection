<xml xmlns="https://developers.google.com/blockly/xml"><variables><variable id="l.cG7u+s.SS@vlnaG#1L">players</variable><variable id="IUDq5TiWZR;Pf)y`wqIi">p</variable><variable id="DXM-ISMH6@g1^w;7Z=iS">q</variable><variable id="whCWBkh@5-BD~PU^k=x`">r</variable><variable id="+r:eOv$Rr]pd#jXQ`W9J">patientZero</variable><variable id="!g(~CP_F%,*2XB#_Sdxn">state</variable><variable id="Ku{{c~2(5E5fo$1hQYd8">master</variable><variable id="MJk1#6adTU?l@d;rVFCw">paired</variable><variable id="-%eV;|@ZOeYz,vY@[O2%">INCUBATION</variable><variable id="4P)_W-)Uc6Z!*=W+Z@;O">DEATH</variable><variable id=";V{5++N/6^g]9a%QxEi}">RSSI</variable><variable id="H1pU[qsc(YuIl{4]6wN]">TRANSMISSIONPROB</variable><variable id="gk`+1^(zP_582Y_3V|@]">playerIcons</variable><variable id="umEMq~0(Xi1xre4pd}A{">infectedBy</variable><variable id="^%amrkEU3g|~}+9]l)-%">playerIcon</variable></variables><comment id="bmQU*(EXlqH+tKd=20U+" data="2" x="590" y="20" h="120" w="160">player state</comment><comment id="EZiij6e!5~~!c|8mt}^p" data="1" x="590" y="153" h="120" w="160">master state</comment><comment id="cdJSnkc*gZ-yN2_sLQ@_" data="0" x="590" y="286" h="360" w="480">Infection game&#10;&#10;Flash all micro:bit will this script&#10;&#10;Press A+B to enter master mode (1 per game)&#10;&#10;Wait for players to be paired. The number of paired player will display on screen.&#10;An icon will appear on player's screen.&#10;&#10;Press A+B to start the infection game. The master will pick a random&#10;player as patient zero.&#10;&#10;A player will transmit the disease if close enough (RSSI)&#10;and with a certain probability (TRANSMISSIONPROB).&#10;During the incudation phase (INCUBATION), the player does not show any sign&#10;of illness. After that phase, the sad face shows up.&#10;&#10;The game will automatically stop once all players are dead or healthy. The master can&#10;also press A+B again to stop the game.&#10;&#10;Once the game is over, the micro:bit will show the player id (A,B,C...), health and&#10;who infected him.&#10;&#10;Icons used in the game:&#10;&#10;Pairing: IconNames.Ghost,7&#10;Paired: IconNames.Happy,&#10;Dead: IconNames.Skull,&#10;Sick: IconNames.Sad,&#10;Incubating: IconNames.Confused,&#10;Healthy: IconNames.Happy</comment><block type="pxt-on-start" id="z0b+3.fC~*#6,Bes%;y+" x="20" y="20"><statement name="HANDLER"><block type="typescript_statement" id="Z[%VfMRzs(;/`@l+aK3g" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let infectedTime = 0" numlines="1" declaredvars="infectedTime"></mutation><next><block type="typescript_statement" id="8$=5l:BjJk`@:a;;]3dy" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let paired = false" numlines="1" declaredvars="paired"></mutation><next><block type="typescript_statement" id="AH0Qfda;KzFw0(dF7uca" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let players: Player[] = []" numlines="1" declaredvars="players"></mutation><next><block type="variables_set" id=")%::sk],YO/)4NHVEC:F"><field name="VAR" id="-%eV;|@ZOeYz,vY@[O2%">INCUBATION</field><comment>time before showing symptoms</comment><data>0</data><value name="VALUE"><shadow type="math_number" id="LctgN$Bz$t/+|ByixYsJ"><field name="NUM">20000</field></shadow></value><next><block type="variables_set" id="QA=YUk6p~BRh.RF1n7TZ"><field name="VAR" id="4P)_W-)Uc6Z!*=W+Z@;O">DEATH</field><comment>time before dying off the disease</comment><value name="VALUE"><shadow type="math_number" id="?r1_lKoQB|W^)PEZUDk="><field name="NUM">40000</field></shadow></value><next><block type="variables_set" id="ZxYd;4T`j%)aD[|VS=ai"><field name="VAR" id=";V{5++N/6^g]9a%QxEi}">RSSI</field><comment>db</comment><value name="VALUE"><shadow type="math_number" id="Y1,6UDGe/{WnG}ae9l!9"><field name="NUM">-45</field></shadow></value><next><block type="variables_set" id="R,Ul0=#S7(O.D-dt2s#^"><field name="VAR" id="H1pU[qsc(YuIl{4]6wN]">TRANSMISSIONPROB</field><comment>% probability to transfer disease</comment><value name="VALUE"><shadow type="math_number" id="OdC}p+;R(-RiWu?3bb$T"><field name="NUM">40</field></shadow></value><next><block type="typescript_statement" id="j9+R}L*eeOM%m=1z[bbp" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="enum GameState {&#13;" line1="    Stopped,&#13;" line2="    Pairing,&#13;" line3="    Running,&#13;" line4="    Over&#13;" line5="}" numlines="6"></mutation><next><block type="typescript_statement" id="mp*gKS,Ztx#8hk^;%_L:" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="enum HealthState {&#13;" line1="    Healthy,&#13;" line2="    Incubating,&#13;" line3="    Sick,&#13;" line4="    Dead&#13;" line5="}" numlines="6"></mutation><next><block type="typescript_statement" id="LgR2:z~k[gUUr-9AmVyb" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="const GameIcons = {&#13;" line1="    Pairing: IconNames.Ghost,&#13;" line2="    Paired: IconNames.Happy,&#13;" line3="    Dead: IconNames.Skull,&#13;" line4="    Sick: IconNames.Sad,&#13;" line5="    Incubating: IconNames.Confused,&#13;" line6="    Healthy: IconNames.Happy&#13;" line7="}" numlines="8" declaredvars="GameIcons"></mutation><next><block type="variables_set" id="?g-F7tDd3gD0Odv.^r40"><field name="VAR" id="gk`+1^(zP_582Y_3V|@]">playerIcons</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="text" id="TRbwHRS,d!cEgc_-43DD"><field name="TEXT">ABCDEFGHIJKLMNOPQRSTUVWXYZ</field></block></value><next><block type="typescript_statement" id="rc,k5$p5W+,IQI/cte(}" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="class Player {&#13;" line1="    id: number;&#13;" line2="    icon: number;&#13;" line3="    health: HealthState;&#13;" line4="    show() {&#13;" line5="        basic.showString(playerIcons[this.icon]);&#13;" line6="    }&#13;" line7="}" numlines="8"></mutation><next><block type="typescript_statement" id="N/T51GrSHW4liW4{~m7/" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let state = GameState.Stopped;" numlines="1" declaredvars="state"></mutation><next><block type="typescript_statement" id="xA3KMS,L`Fk:j|wJEUol" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let patientZero: Player;" numlines="1" declaredvars="patientZero"></mutation><next><block type="variables_set" id="ybKDaRt%*f0-+aZUD=(="><field name="VAR" id="umEMq~0(Xi1xre4pd}A{">infectedBy</field><comment>who infected (playerIcon)</comment><value name="VALUE"><shadow type="math_number" id="m#Z[NTxasznMGl2~Ec$P"><field name="NUM">-1</field></shadow></value><next><block type="variables_set" id="Qr`P$7EbA!v[%j.KFjAL"><field name="VAR" id="^%amrkEU3g|~}+9]l)-%">playerIcon</field><comment>local time when infection happened&#10;player icon and identity</comment><value name="VALUE"><shadow type="math_number" id="7en[:i!x[aUR$uHz0;6V"><field name="NUM">-1</field></shadow></value><next><block type="typescript_statement" id="`[;{xZcyApG@W=Q~CS@!" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let health = HealthState.Healthy;" numlines="1" declaredvars="health"></mutation><next><block type="radio_set_group" id="?FV4shWN!Bs}CPb.gcRe"><value name="ID"><shadow type="math_number_minmax" id="4ja3ixd82d}MVR{UA0MH"><mutation min="0" max="255" label="Number" precision="0"/><field name="SLIDER">42</field></shadow></value><next><block type="radio_set_transmit_serial_number" id="2FV[]gPoL8Sda2Q.VcYF"><value name="transmit"><shadow type="logic_boolean" id="ZV8tjG`#Coj[KO6;MJ,l"><field name="BOOL">TRUE</field></shadow></value><next><block type="typescript_statement" id="__lk1;-#v?fTc2)bE/,6" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="basic.showIcon(GameIcons.Pairing)" numlines="1"></mutation></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type="function_definition" id="ZaMo;}eEKvdzU6K{iRJg" x="1115" y="20"><mutation name="player" functionid="x6q-t{4l*@]Th6dWoziG"><arg name="id" id="eai6n25hv47f01im8u4" type="number"/></mutation><field name="function_name">player</field><comment>get a player instance (creates one as needed)</comment><statement name="STACK"><block type="pxt_controls_for_of" id="JOwVq6og|=2Hp6O^)sjU"><value name="VAR"><shadow type="variables_get_reporter" id="lH_Nv8FxDAg;x_)U)spV"><field name="VAR" id="IUDq5TiWZR;Pf)y`wqIi">p</field></shadow></value><value name="LIST"><block type="variables_get" id=".QctfHg8upi!BrZm+t56"><field name="VAR" id="l.cG7u+s.SS@vlnaG#1L">players</field></block></value><statement name="DO"><block type="controls_if" id="RXaox_X1A5DC1;)~VQfP"><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="-}+?v9wM/lbrMI1Lp!xg"><field name="OP">EQ</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="typescript_expression" id="-b=MDoFv7mtkUHK1D5jM" editable="false"><field name="EXPRESSION">p.id</field></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="argument_reporter_number" id="KBq5MTw=GI0V*3dLR|DV"><field name="VALUE">id</field></block></value></block></value><statement name="DO0"><block type="function_return" id="+L3.%`Av,8)wa6=Z`3{="><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="P,Ist;8}Kww@xDiBW^=u"><field name="VAR" id="IUDq5TiWZR;Pf)y`wqIi">p</field></block></value></block></statement></block></statement><next><block type="typescript_statement" id=".i0XC{eW2R%54$)^-(Cu" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let q = new Player();" numlines="1" declaredvars="q"></mutation><next><block type="typescript_statement" id="V*xS6hz|zPf%)ii2Bm-8" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="q.id = id;" numlines="1"></mutation><next><block type="typescript_statement" id=")mB{IgSw$Vq3a0JLtnH." editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="q.icon = (players.length + 1) % playerIcons.length;" numlines="1"></mutation><next><block type="typescript_statement" id="rdV#G^H4yg;66vvjRk4{" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="q.health = HealthState.Healthy;" numlines="1"></mutation><next><block type="array_push" id="XteH4b1A,9bcm+{BPq]~"><value name="list"><block type="variables_get" id="ETo]{e?vfs^g}i)eFZ38"><field name="VAR" id="l.cG7u+s.SS@vlnaG#1L">players</field></block></value><value name="value"><block type="variables_get" id="p!rNsO-z:l6|q3qF,#_`"><field name="VAR" id="DXM-ISMH6@g1^w;7Z=iS">q</field></block></value><next><block type="serial_writeline" id="B5boc]$,rMP5;HtW%ZYO"><value name="text"><block type="typescript_expression" id="[.SZk8{*##/U:Vx,!:JM" editable="false"><field name="EXPRESSION">`player ==&gt; ${q.id}`</field></block></value><next><block type="function_return" id="e]qofh`Y}kaZ[^;QrMZ["><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="s8XqAkq2FY+/2AA]ii-X"><field name="VAR" id="DXM-ISMH6@g1^w;7Z=iS">q</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type="function_definition" id="CD8RS1_*r1cY{$:aKq#{" x="1693" y="20"><mutation name="allDead" functionid="@GIO/6)54=}d.u=]/G?p"/><field name="function_name">allDead</field><statement name="STACK"><block type="pxt_controls_for_of" id="Tx,I/qKb3zZPrUa|g*gG"><value name="VAR"><shadow type="variables_get_reporter" id="8.Ww}V2m@jtQ[eb63VVn"><field name="VAR" id="whCWBkh@5-BD~PU^k=x`">r</field></shadow></value><value name="LIST"><block type="variables_get" id="I$t{tD59omO@P7eo24BC"><field name="VAR" id="l.cG7u+s.SS@vlnaG#1L">players</field></block></value><statement name="DO"><block type="controls_if" id="DY1~_7n244%R004P!%ym"><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="OwdSD0+]+q(T~|FhAIIw"><field name="OP">NEQ</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="typescript_expression" id="#hIa-?vFE3.4/Zg~}`|}" editable="false"><field name="EXPRESSION">r.health</field></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="typescript_expression" id="mfo/jb^N,0(E$2/E|NBa" editable="false"><field name="EXPRESSION">HealthState.Dead</field></block></value></block></value><statement name="DO0"><block type="function_return" id="6jnh.{M@p|,$?_.Am+QV"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="logic_boolean" id="Yb2Wcq@CJ{aJVzv;e$G."><field name="BOOL">FALSE</field></block></value></block></statement></block></statement><next><block type="function_return" id="~jX:0cYAHRPGwHw(s2#u"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="logic_boolean" id="qI9}{p-dLShgCf_%*%et"><field name="BOOL">TRUE</field></block></value></block></next></block></statement></block><block type="function_definition" id="N]$()Ji3%%HvIDt!vh|9" x="2354" y="20"><mutation name="gameOver" functionid="DuSx^v};Sk|Y0`(eCXSn"/><field name="function_name">gameOver</field><statement name="STACK"><block type="typescript_statement" id="iQAe1uE~#=m[.Ds_+FA:" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="state = GameState.Over;" numlines="1"></mutation><next><block type="controls_if" id="sN@`~$mCHs6,?zNVD{.!"><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="variables_get" id="#*;KMS|G71YmHzGm!Ew7"><field name="VAR" id="+r:eOv$Rr]pd#jXQ`W9J">patientZero</field></block></value><statement name="DO0"><block type="typescript_statement" id="peU+Nm!s-ke0PoA,f.9)" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="patientZero.show();" numlines="1"></mutation></block></statement></block></next></block></statement></block><block type="function_definition" id="Jm=DXrS_m`hy[!WuE$nG" x="2719" y="20"><mutation name="gameFace" functionid="z$HAg(j{rQ0YiMY.z8br"/><field name="function_name">gameFace</field><statement name="STACK"><block type="typescript_statement" id="44k8nm)~)g/_z%?i@}(e" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="switch (state) {&#13;" line1="        case GameState.Stopped:&#13;" line2="            basic.showIcon(GameIcons.Pairing);&#13;" line3="            break;&#13;" line4="        case GameState.Pairing:&#13;" line5="            if (playerIcon &gt; -1)&#13;" line6="                basic.showString(playerIcons[playerIcon]);&#13;" line7="            else&#13;" line8="                basic.showIcon(paired ? GameIcons.Paired : GameIcons.Pairing, 1);&#13;" line9="            break;&#13;" line10="        case GameState.Running:&#13;" line11="            switch (health) {&#13;" line12="                case HealthState.Dead:&#13;" line13="                    basic.showIcon(GameIcons.Dead, 1);&#13;" line14="                    break;&#13;" line15="                case HealthState.Sick:&#13;" line16="                    basic.showIcon(GameIcons.Sick, 1);&#13;" line17="                    break;&#13;" line18="                default:&#13;" line19="                    basic.showIcon(GameIcons.Healthy, 1);&#13;" line20="                    break;&#13;" line21="            }&#13;" line22="            break;&#13;" line23="        case GameState.Over:&#13;" line24="            // show id&#13;" line25="            basic.showString(playerIcons[playerIcon]);&#13;" line26="            basic.pause(2000);&#13;" line27="            // show health&#13;" line28="            switch (health) {&#13;" line29="                case HealthState.Dead:&#13;" line30="                    basic.showIcon(GameIcons.Dead, 2000);&#13;" line31="                    break;&#13;" line32="                case HealthState.Sick:&#13;" line33="                    basic.showIcon(GameIcons.Sick, 2000);&#13;" line34="                    break;&#13;" line35="                case HealthState.Incubating:&#13;" line36="                    basic.showIcon(GameIcons.Incubating, 2000);&#13;" line37="                    break;&#13;" line38="                default:&#13;" line39="                    basic.showIcon(GameIcons.Healthy, 2000);&#13;" line40="                    break;&#13;" line41="            }&#13;" line42="            // show how infected&#13;" line43="            if (infectedBy &gt; -1) {&#13;" line44="                basic.showString(&quot; INFECTED BY&quot;);&#13;" line45="                basic.showString(playerIcons[infectedBy]);&#13;" line46="                basic.pause(2000);&#13;" line47="            } else {&#13;" line48="                basic.showString(&quot; PATIENT ZERO&quot;);&#13;" line49="                basic.pause(2000);&#13;" line50="            }&#13;" line51="            // show score&#13;" line52="            game.showScore();&#13;" line53="            basic.pause(1000);&#13;" line54="            break;&#13;" line55="    }" numlines="56"></mutation></block></statement></block><block type="device_button_event" id="3bzI.t75*ndhyxi#^Oe2" x="3569" y="20"><field name="NAME">Button.AB</field><statement name="HANDLER"><block type="controls_if" id="3x?!|yky70KyHlXJ8@Z6"><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_operation" id="k)H0mrU9PCI(u4hBZnA^"><field name="OP">AND</field><value name="A"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="$/K74|(aO!T;VVO:$HX?"><field name="OP">EQ</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="hbs_/?+oCo`+iNG*?+Q;"><field name="VAR" id="!g(~CP_F%,*2XB#_Sdxn">state</field></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="typescript_expression" id="}lUEzH:-S#K)~^:d7$$f" editable="false"><field name="EXPRESSION">GameState.Stopped</field></block></value></block></value><value name="B"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_negate" id="t8vRYY-4d}2)t0Pzrf)4"><value name="BOOL"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="variables_get" id="jUgR):A`$yn8}tXYy[Q!"><field name="VAR" id="Ku{{c~2(5E5fo$1hQYd8">master</field></block></value></block></value></block></value><statement name="DO0"><block type="variables_set" id="Ton3RL*Df}]j#0a`5~@X"><field name="VAR" id="Ku{{c~2(5E5fo$1hQYd8">master</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="logic_boolean" id="JkF3Dr(h+zJXvQJv2~fe"><field name="BOOL">TRUE</field></block></value><next><block type="variables_set" id="Ow{]b2Ek1,mhDdo$i*:|"><field name="VAR" id="MJk1#6adTU?l@d;rVFCw">paired</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="logic_boolean" id="Up-zsMgg%S1{ut|{_EWS"><field name="BOOL">TRUE</field></block></value><next><block type="typescript_statement" id="0D!0f@1n?TWCNh$88%m1" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="state = GameState.Pairing;" numlines="1"></mutation><next><block type="serial_writeline" id="!/.q{a?k3Jg3b(Q|Pw=q"><value name="text"><shadow type="text" id="I5cku-f]vm%cWKya~+%V"><field name="TEXT">registered as master</field></shadow></value><next><block type="radio_set_transmit_power" id="EfvH*#)i,}h6K6)l?tSU"><value name="power"><shadow type="math_number_minmax" id=";%P.X9q]Z9g#)jmg)5_6"><mutation min="0" max="7" label="Number" precision="0"/><field name="SLIDER">7</field></shadow></value><next><block type="device_print_message" id="BZuJ+qPw|Q+@^fP95S7d"><value name="text"><shadow type="text" id="38Js4r,+eQ_)}i,1c2go"><field name="TEXT">0</field></shadow></value><next><block type="typescript_statement" id="K?FXh^H0)gRcP?wh(Vg=" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="return;" numlines="1"></mutation></block></next></block></next></block></next></block></next></block></next></block></next></block></statement><next><block type="controls_if" id="?Y(x*M|i#,GgEy]2zaVU"><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_negate" id="R!q:E#YZf5k69cNg/v/V"><value name="BOOL"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="variables_get" id="|m|R_0qFPVy%~L3:u+nf"><field name="VAR" id="Ku{{c~2(5E5fo$1hQYd8">master</field></block></value></block></value><statement name="DO0"><block type="typescript_statement" id="fvWco^kt,AML_Ej?eW1/" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="return;" numlines="1"></mutation></block></statement><next><block type="controls_if" id="hoDnjrbN/cIhPEBJJRvo"><mutation elseif="1"/><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id=":;Yu4E.U1#E/j;.dc9U+"><field name="OP">EQ</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="IDby/_u[`)W=9eQ*q;oH"><field name="VAR" id="!g(~CP_F%,*2XB#_Sdxn">state</field></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="typescript_expression" id="f$6Hc.}6,kM.[6WEM;r7" editable="false"><field name="EXPRESSION">GameState.Pairing</field></block></value></block></value><statement name="DO0"><block type="variables_set" id="UrnT2s)gwopBqdr@rKin"><field name="VAR" id="+r:eOv$Rr]pd#jXQ`W9J">patientZero</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="lists_index_get" id="z!e`l_|NT(tg5-7nIIDq"><value name="LIST"><block type="variables_get" id="Cg$%SEoL.(NiOKI6^m5f"><field name="VAR" id="l.cG7u+s.SS@vlnaG#1L">players</field></block></value><value name="INDEX"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="device_random_deprecated" id="+[gchSFV4qv:g{IH#hLI"><value name="min"><shadow type="math_number" id="{gl::HZ+}A-5e,X-2$n="><field name="NUM">0</field></shadow></value><value name="limit"><block type="lists_length" id="qLArixfbjPfX6#hVWh.B"><value name="VALUE"><block type="variables_get" id=".8[E%`M^vF3#f?V}5wI%"><field name="VAR" id="l.cG7u+s.SS@vlnaG#1L">players</field></block></value></block></value></block></value></block></value><next><block type="device_while" id="|48ob89a~@@ESdB7wvZZ"><value name="COND"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="78D3]U^6_w3uWe63Pq?C"><field name="OP">EQ</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="typescript_expression" id="=2z({ju}L`/n8.H@1OrB" editable="false"><field name="EXPRESSION">patientZero.health</field></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="typescript_expression" id="fN6[x)WaUY0OR:GF/9%R" editable="false"><field name="EXPRESSION">HealthState.Healthy</field></block></value></block></value><statement name="DO"><block type="radio_datagram_send_value" id="mJ2ta;=+$RZ_ZYuj.5LD"><value name="name"><shadow type="text" id="Jh=h,_QE@0[YzE~Ae/F4"><field name="TEXT">infect</field></shadow></value><value name="value"><block type="typescript_expression" id="?f8:2lH=Zr.X],_QDtyy" editable="false"><field name="EXPRESSION">patientZero.id</field></block></value><next><block type="device_pause" id="Ayoh.~8haDsgYLFgfxO)"><value name="pause"><shadow type="timePicker" id=")yN=mAtb{4;(][VtHesl"><field name="ms">100</field></shadow></value></block></next></block></statement><next><block type="typescript_statement" id="H==@adist$aSfN!AD=QO" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="state = GameState.Running;" numlines="1"></mutation><next><block type="serial_writeline" id="A0Z(!c4-]_cz{ncxV.%J"><value name="text"><block type="typescript_expression" id="kR0;@is[=?v~=gs^.P{{" editable="false"><field name="EXPRESSION">`game started ${players.length} players`</field></block></value><next><block type="typescript_statement" id="/j]9i$Gp.-B][yZCH:,b" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="basic.showIcon(GameIcons.Dead);" numlines="1"></mutation></block></next></block></next></block></next></block></next></block></statement><value name="IF1"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="?Z+6GSG;-%?WdD8u~}94"><field name="OP">EQ</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="6;}5O2`B2ap3!vwNl#(s"><field name="VAR" id="!g(~CP_F%,*2XB#_Sdxn">state</field></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="typescript_expression" id="GSa{.A+jRH9D}vU]A9i9" editable="false"><field name="EXPRESSION">GameState.Running</field></block></value></block></value><statement name="DO1"><block type="function_call" id="L;Z]%I)+}4vVWcR/Al6)"><mutation name="gameOver" functionid="DuSx^v};Sk|Y0`(eCXSn"/></block></statement></block></next></block></next></block></statement></block><block type="radio_on_packet" id="!#=B*;d?|9Q_+JdfpqH{" disabled="true" x="20" y="2415"/><block type="device_forever" id="|gwg,42eH}iU$_nF!@/w" x="231" y="2415"><statement name="HANDLER"><block type="controls_if" id="2Y/_,xR6Q#ra%iu^dpQf"><mutation else="1"/><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="variables_get" id="v#w.1yKHoJ~i+yKllZ=B"><field name="VAR" id="Ku{{c~2(5E5fo$1hQYd8">master</field></block></value><statement name="DO0"><block type="typescript_statement" id="GX)GxN/n/CYzz|/8q0OZ" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="switch (state) {&#13;" line1="            case GameState.Pairing:&#13;" line2="                // tell each player they are registered&#13;" line3="                for (const u of players) {&#13;" line4="                    radio.sendValue(&quot;paired&quot;, u.id);&#13;" line5="                    radio.sendValue(&quot;i&quot; + u.id, u.icon);&#13;" line6="                }&#13;" line7="                serial.writeLine(`pairing ${players.length} players`);&#13;" line8="                basic.pause(500);&#13;" line9="                break;&#13;" line10="            case GameState.Running:&#13;" line11="                for (const v of players) {&#13;" line12="                    radio.sendValue(&quot;h&quot; + v.id, v.health);&#13;" line13="                }&#13;" line14="                break;&#13;" line15="            case GameState.Over:&#13;" line16="                if (patientZero)&#13;" line17="                    patientZero.show();&#13;" line18="                break;&#13;" line19="        }" numlines="20"></mutation><next><block type="radio_datagram_send_value" id="Ll26p{#7Nc6SmmK1Y_OE"><value name="name"><shadow type="text" id="cRxl75)taI!!43+f}T_X"><field name="TEXT">state</field></shadow></value><value name="value"><block type="variables_get" id="-5K!$C6$ES1x[k!WZxU+"><field name="VAR" id="!g(~CP_F%,*2XB#_Sdxn">state</field></block></value></block></next></block></statement><statement name="ELSE"><block type="typescript_statement" id="09zFu{#?H_Za.pW:ezBd" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="switch (state) {&#13;" line1="            case GameState.Pairing:&#13;" line2="                // broadcast player id&#13;" line3="                if (playerIcon &lt; 0)&#13;" line4="                    radio.sendValue(&quot;pair&quot;, control.deviceSerialNumber());&#13;" line5="                else if (infectedBy &gt; -1)&#13;" line6="                    radio.sendValue(&quot;health&quot;, health);&#13;" line7="                break;&#13;" line8="            case GameState.Running:&#13;" line9="                // update health status&#13;" line10="                if (health != HealthState.Healthy &amp;&amp; input.runningTime() - infectedTime &gt; DEATH)&#13;" line11="                    health = HealthState.Dead;&#13;" line12="                else if (health != HealthState.Healthy &amp;&amp; input.runningTime() - infectedTime &gt; INCUBATION)&#13;" line13="                    health = HealthState.Sick;&#13;" line14="                // transmit disease&#13;" line15="                if (health == HealthState.Incubating || health == HealthState.Sick)&#13;" line16="                    radio.sendValue(&quot;transmit&quot;, playerIcon);&#13;" line17="                radio.sendValue(&quot;health&quot;, health);&#13;" line18="                break;&#13;" line19="        }" numlines="20"></mutation><next><block type="function_call" id="TXzF!D{1vJ;ioJ)rE7OQ"><mutation name="gameFace" functionid="z$HAg(j{rQ0YiMY.z8br"/></block></next></block></statement></block></statement></block></xml>